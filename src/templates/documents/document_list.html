{% extends "base.html" %}
{% load compressed %}

{% block additional_navbar %}
    {% include 'documents/document_action_form.html' %}
{% endblock %}

{% block content %}
    <div id="document-list-row" class="row row-offcanvas row-offcanvas-right">
        <div class="col-md-12 col-lg-10">
            <div class="table-responsive">
                {% include "documents/custom/list_table.html" %}
            </div>
        </div>

        <div class="col-lg-2 sidebar-offcanvas" id="sidebar">
            <button id="toggle-filters-button"
                    type="button"
                    class="btn btn-primary visible-xs visible-sm visible-md"
                    data-toggle="offcanvas">
                <span class="glyphicon glyphicon-arrow-left"></span> Filters
            </button>
            <form action="{% url 'document_filter' %}"
                  method="get"
                  id="table-filters">
                {% for hidden in form.hidden_fields %}{{ hidden }}{% endfor %}
                {% include "documents/form_filtering.html" %}
            </form>
        </div>
    </div>
{% endblock %}

{% block extra_js %}
    {% compressed_js "list" %}
    {% compressed_js "datatable" %}

    <script>
    var config = {
        userId: {% if request.user.is_authenticated %}{{ request.user.id }}{% else %}undefined{% endif %},
        csrfToken: "{{ csrf_token }}",
        createUrl: "{% url "favorite_create" %}",
        deleteUrl: "{% url "favorite_delete" "0" %}",
        filterUrl: "{% url "document_filter" %}",
        detailUrl: "{% url "document_detail" "documentNumber" %}",
        numPages: {{ paginator.num_pages }},
        totalItems: {{ paginator.count }},
        numItemsPerPage: {{ items_per_page }}
    };
    var tableData = {{ initial_data|safe }};

    </script>
{% endblock extra_js %}
