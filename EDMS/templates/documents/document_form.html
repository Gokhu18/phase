{% extends "base.html" %}

{% block extra_css %}
    <link rel="stylesheet" href="{{ STATIC_URL }}css/bootstrap-fileupload.css">
    <link rel="stylesheet" href="{{ STATIC_URL }}css/jquery.multiselect.css" />
    <link rel="stylesheet" href="{{ STATIC_URL }}css/jquery.multiselect.filter.css" />
{% endblock extra_css %}

{% block createdocument %}{% endblock createdocument %}

{% block content %}
    <h2>{% if is_edit %}Edit{% else %}New{% endif %} document</h2>
    <form action="."
          method="post"
          class="form-horizontal"
          enctype="multipart/form-data"
          id="document-edit">
        {% csrf_token %}
        {% if form.non_field_errors %}
            <div class="alert alert-error">
                <p><strong>Please fix this error:</strong> {{ form.non_field_errors.0 }}</p>
            </div>
        {% endif %}
        {% include "documents/form_general_information.html" %}
        {% include "documents/form_revision.html" %}
        {% include "documents/form_review.html" %}
        {% include "documents/form_related_documents.html" %}
        {% include "documents/form_schedule.html" %}
        <div class="form-actions">
            <a class="btn pull-left" href="{% url "document_list" %}">Cancel</a>
            <input class="btn btn-primary pull-right last-button"
                   type="submit"
                   value="Save and close"
                   name="save-close">
            {% if is_edit %}
                <input class="btn btn-info pull-right"
                       type="submit"
                       value="Save"
                       name="save-view">
            {% else %}
                <input class="btn btn-info pull-right"
                       type="submit"
                       value="Save and create another document"
                       name="save-create">
            {% endif %}
        </div>
    </form>
{% endblock content %}

{% block extra_js %}
    <script src="{{ STATIC_URL }}js/bootstrap-fileupload.js"></script>
    <script src="{{ STATIC_URL }}js/jquery.multiselect.js"></script>
    <script src="{{ STATIC_URL }}js/jquery.multiselect.filter.js"></script>
    <script type="text/javascript">
        var labels = $.makeArray($("#id_related_documents option")
                      .map(function(){ return $(this).text() }));
        $('#id_related_documents').multiselect().multiselectfilter();
    </script>
{% endblock extra_js %}

